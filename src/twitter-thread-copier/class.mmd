classDiagram
    class Main {
        +初期化処理
        +状態管理
        +デバッグ機能
        +起点設定状態管理
    }

    class ShadowDOMManager {
        +init()
        +addStyles()
        +querySelector()
        +appendChild()
        +destroy()
        +シャドウDOMホスト管理
    }

    class UI {
        +addStyles()
        +addControlPanel()
        +showToast()
        +removeButton()
        +updateResetButton()
        +updateMainCopyButtonText()
    }

    class StartPointManager {
        +addStartPointButtons()
        +setStartPoint()
        +resetStartPoint()
        +起点ボタン管理
        +視覚的フィードバック
        +起点状態維持
    }

    class TwitterAPI {
        +isTwitterStatusPage()
        +observeUrlChanges()
        +ページ変更検出
        +自動起点リセット
    }

    class ContentExtractor {
        +copyThreadContent()
        +collectVisibleTweets()
        +scrollAndCollect()
        +expandTruncatedTweets()
        +起点フィルタリング
    }

    class TextProcessor {
        +getTweetFullText()
        +formatDateTime()
        +formatByteSize()
        +preserveLineBreaks()
        +cleanupObjectText()
        +getDisplayName()
        +getUsernameHandle()
    }

    class TweetFormatter {
        +formatSingleTweet()
        +formatTweetsWithLimit()
        +formatAllTweets()
        +generateSummary()
        +起点対応サマリー生成
    }

    class EmojiProcessor {
        +extractEmojiImages()
        +getEmojiFromImageSrc()
        +convertEmojiCodepointsToChar()
        +insertEmojiToText()
    }

    class URLResolver {
        +resolveTwitterShortUrls()
        +followRedirect()
        +escapeRegExp()
    }

    class MediaExtractor {
        +getMediaUrls()
        +getHighQualityMediaUrl()
        +getVideoUrl()
        +getQuotedTweet()
        +extractQuotedTweetInfo()
    }

    class Translator {
        +translateText()
        +GoogleTranslateAPI連携
        +URLプレースホルダー処理
        +ユーザー名プレースホルダー処理
        +日時プレースホルダー処理
        +絵文字プレースホルダー処理
        +プレースホルダー置換と復元
        +restorePlaceholders()
        +findRemainingPlaceholders()
    }

    class ClipboardManager {
        +executeClipboardCopy()
        +複数コピー方式対応
        +エラーハンドリング
    }

    class CopyModeManager {
        +コピーモード管理
        +モード切替処理
        +文字数制限チェック
        +モード別フォーマット適用
        +起点対応処理
    }

    class StateManager {
        +collectedThreadData
        +isCollecting
        +isSecondStage
        +translateEnabled
        +translationInProgress
        +copyMode
        +startFromTweetId
        +startFromTweetAuthor
        +startFromTweetText
    }

    Main --> ShadowDOMManager
    Main --> UI
    Main --> TwitterAPI
    Main --> ContentExtractor
    Main --> CopyModeManager
    Main --> StartPointManager
    Main --> StateManager
    
    ShadowDOMManager --> UI
    UI --> StartPointManager
    StartPointManager --> TextProcessor
    TwitterAPI --> StartPointManager
    
    ContentExtractor --> TextProcessor
    ContentExtractor --> MediaExtractor
    ContentExtractor --> Translator
    ContentExtractor --> ClipboardManager
    ContentExtractor --> StateManager
    
    TextProcessor --> URLResolver
    TextProcessor --> EmojiProcessor
    Translator --> URLResolver
    CopyModeManager --> TweetFormatter
    TweetFormatter --> TextProcessor
    TweetFormatter --> StateManager 